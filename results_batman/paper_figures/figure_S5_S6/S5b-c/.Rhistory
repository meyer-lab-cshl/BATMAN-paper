source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
# Load TCR and peptide information from the main TCR datafile
suppressWarnings(
TCR_pMHC_data <- read_excel(paste0("../../tcr_epitope_datasets/",
"mutational_scan_datasets/train_test_data_folds.xlsx"))
)
# Subset selected TCRs and columns
TCR_list_9mer <- c('a3a','TIL1383I','TCR81-14','18A2','NYE-S1','TCR6','TCR7',
'A6','T1','FLT3DY','A23','TCR2-T','R24','868Z11')
TCR_list_10mer <- c('TCR-1E6', 'APN-TCR', 'EWW-TCR', 'A11Va')
TCR_list_mhcii<- c('TCR-F5','TCR-3598-2','MBP-TCR','B3K508')
all_TCRs <- c(TCR_list_9mer,TCR_list_10mer,TCR_list_mhcii)
TCR_pMHC_data <- TCR_pMHC_data[TCR_pMHC_data$tcr %in% all_TCRs,]
TCR_pMHC_data <- select(TCR_pMHC_data,c('tcr','index_peptide','peptide','peptide_activity'))
# open empty df for storing AUC
score_all_methods <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL, c("tcr", "method",
"score",'peptide_activity'))))
# open empty df for storing AUC
score_all_methods <- data.frame(matrix(ncol=4,nrow=0,
dimnames=list(NULL, c("tcr", "method",
"score",'peptide_activity'))))
#load data
scores_df <- read.csv(paste0('tcr_pmhc_methods_predictions/atmtcr/',
'pred_original_atmtcr_input.csv'),
header=FALSE,
sep="\t")
scores_df <- read.csv(paste0('../figure_2/tcr_pmhc_methods_predictions/atmtcr/',
'pred_original_atmtcr_input.csv'),
header=FALSE,
sep="\t")
scores_df <- read.csv(paste0('../figure_2/2a/tcr_pmhc_methods_predictions/atmtcr/',
'pred_original_atmtcr_input.csv'),
header=FALSE,
sep="\t")
# set rownames to peptide (unique in data)
rownames(scores_df) <- scores_df$V1
# Subset of TCRs with scores available
TCR_data_subset <- TCR_pMHC_data[TCR_pMHC_data$peptide %in% scores_df$V1,]
#extract score
TCR_data_subset$score <- scores_df[TCR_data_subset$peptide,]$V5
View(TCR_data_subset)
View(TCR_data_subset)
# open empty df for storing AUC
score_all_methods <- data.frame(matrix(ncol=6,nrow=0,
dimnames=list(NULL, c('tcr','index_peptide',
'peptide','peptide_activity',
'score','method'))))
# stores scores for different methods
############
# ATM-TCR
############
#load data
scores_df <- read.csv(paste0('../figure_2/2a/tcr_pmhc_methods_predictions/atmtcr/',
'pred_original_atmtcr_input.csv'),
header=FALSE,
sep="\t")
# set rownames to peptide (unique in data)
rownames(scores_df) <- scores_df$V1
# Subset of TCRs with scores available
TCR_data_subset <- TCR_pMHC_data[TCR_pMHC_data$peptide %in% scores_df$V1,]
#extract score
TCR_data_subset$score <- scores_df[TCR_data_subset$peptide,]$V5
TCR_data_subset$method <- "ATM-TCR"
# Add to data
score_all_methods <- rbind(score_all_methods,TCR_data_subset)
View(score_all_methods)
View(score_all_methods)
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
View(score_all_methods)
View(score_all_methods)
View(score_all_methods)
View(score_all_methods)
View(score_all_methods)
View(score_all_methods)
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S4/plot_methods_scores_for_S4.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
View(corr_df)
View(corr_df)
corr_df$aa <- toupper(corr_df$aa)
View(corr_df)
View(corr_df)
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
View(corr_df)
View(corr_df)
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5a/plot_corrs_for_S5a.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
View(auc_df)
View(auc_df)
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
mean(auc_df$mean_auc[auc_df$aa_matrix=='HAMMING'])
mean(auc_df$mean_auc[auc_df$aa_matrix=='BLOSUM100'])
median(auc_df$mean_auc[auc_df$aa_matrix=='HAMMING'])
median(auc_df$mean_auc[auc_df$aa_matrix=='BLOSUM100'])
median(auc_df$mean_auc[auc_df$aa_matrix=='PAM10'])
mean(auc_df$mean_auc[auc_df$aa_matrix=='PAM10'])
auc_df_subset <- auc_df[auc_df$aa_matrix %in% c('HAMMING','BLOSUM100','PAM10',
'DAYHOFF','GONNET'),]
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
auc_df_subset <- pivot_longer(auc_df_subset,
cols = c('WS','NS','NW'),
names_to = 'pair')
library(tidyr)
auc_df_subset <- pivot_longer(auc_df_subset,
cols = c('WS','NS','NW'),
names_to = 'pair')
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
auc_df_subset <- auc_df[auc_df$aa_matrix %in% c('HAMMING','BLOSUM100','PAM10',
'DAYHOFF','GONNET'),]
auc_df_subset <- pivot_longer(auc_df_subset,
cols = c('WS','NS','NW'),
names_to = 'pair',
values_to = 'auc')
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
TCR_data <- read_excel(paste0('../../tcr_epitope_datasets/mutational_scan_datasets',
'/train_test_data_folds.xlsx'))
TCR_data <- read_excel(paste0('../../../tcr_epitope_datasets/mutational_scan_datasets',
'/train_test_data_folds.xlsx'))
TCR_data <- unique(TCR_data[c('tcr','index_peptide')])
View(TCR_data)
View(TCR_data)
# Plot for selected AA matrices
auc_df_subset <- auc_df[auc_df$aa_matrix %in% c('HAMMING','BLOSUM100','PAM10',
'DAYHOFF','GONNET'),]
# Add index peptides
auc_df_subset$index_peptide <- TCR_data$index_peptide[auc_df_subset$tcr]
View(auc_df_subset)
View(auc_df_subset)
View(TCR_data)
View(TCR_data)
auc_df_subset$index_peptide <- TCR_data$index_peptide[auc_df_subset$tcr,]
View(TCR_data)
View(TCR_data)
auc_df_subset$index_peptide <- TCR_data[auc_df_subset$tcr,2]
View(auc_df_subset)
View(auc_df_subset)
a <- auc_df_subset$tcr
b<- TCR_data[tcrs,]
tcrs <- auc_df_subset$tcr
b<- TCR_data[tcrs,]
View(b)
View(b)
View(TCR_data)
View(TCR_data)
TCR_data <- read_excel(paste0('../../../tcr_epitope_datasets/mutational_scan_datasets',
'/train_test_data_folds.xlsx'))
TCR_data <- unique(TCR_data[c('tcr','index_peptide')])
rownames(TCR_data) <- TCR_data$tcr
row.names(TCR_data) <- TCR_data$tcr
TCR_data <- read_excel(paste0('../../../tcr_epitope_datasets/mutational_scan_datasets',
'/train_test_data_folds.xlsx'))
TCR_data <- unique(TCR_data[c('tcr','index_peptide')])
rownames(TCR_data) <- TCR_data[,1]
View(TCR_data)
View(TCR_data)
TCR_data <- data.frame(TCR_data, row.names = 1)
View(TCR_data)
View(TCR_data)
auc_df_subset$index_peptide <- TCR_data[auc_df_subset$tcr,]
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
View(auc_df_subset)
# Plot for selected AA matrices
auc_df_subset <- auc_df[auc_df$aa_matrix %in% c('HAMMING','BLOSUM100','PAM10',
'DAYHOFF','GONNET'),]
# Add index peptides
auc_df_subset$index_peptide <- TCR_data[auc_df_subset$tcr,]
auc_df_subset <- pivot_longer(auc_df_subset,
cols = c('WS','NS','NW'),
names_to = 'pair',
values_to = 'auc')
View(auc_df_subset)
View(auc_df_subset)
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
View(auc_df_subset)
View(auc_df_subset)
View(auc_by_index)
View(auc_by_index)
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
source("~/batman_resub/paper_figures/figure_S5/S5b-c/plot_aucss_for_S5b-c.R")
