colorRampPalette(brewer.pal(7, "Set1"))(22)[1:14]
library(RColorBrewer)
colorRampPalette(brewer.pal(7, "Set1"))(22)[1:14]
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
View(weights_all)
View(weights_all)
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
View(weights_all)
View(weights_all)
weights_all$position <- gsub("P","",as.character(weights_all$position))
View(weights_all)
View(weights_all)
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
weights_all <- weights_all %>% group_by(tcr,aa_matrix)
View(weights_all)
View(weights_all)
weights_all <- weights_all %>%
group_by(tcr,aa_matrix) %>%
summarise(w_max=max(weight))
View(weights_all)
View(weights_all)
# Read and add to weights data
### Inferred Symmetric
weights_all <- read.csv('inferred_weights/inferred_weights_symm.csv')
colnames(weights_all) <- c('tcr','P1','P2','P3','P4','P5','P6','P7','P8','P9')
weights_all <- pivot_longer(weights_all,
cols = c('P1','P2','P3','P4','P5','P6','P7','P8','P9'))
colnames(weights_all) <- c('tcr','position','weight')
weights_all$aa_matrix <- 'Inferred Symmetric'
for (aa in c('full','Hamming','BLOSUM100','PAM10','DAYHOFF','GONNET')){
weights <- read.csv(paste0('inferred_weights/inferred_weights_',aa,'.csv'))
colnames(weights) <- c('tcr','P1','P2','P3','P4','P5','P6','P7','P8','P9')
weights <- pivot_longer(weights,
cols = c('P1','P2','P3','P4','P5',
'P6','P7','P8','P9'))
colnames(weights) <- c('tcr','position','weight')
weights$aa_matrix <- aa
weights_all <- rbind(weights_all,weights)
}
weights_all <- weights_all %>%
group_by(tcr,aa_matrix) %>%
mutate(w_max=max(weight))
View(weights_all)
View(weights_all)
source("~/batman_resub/paper_figures/figure_S8/plot_weights_for_S8.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
auc_all <- pivot_longer(auc_all,
cols = all_of(all_TCRs),
names_to = 'tcr',
values_to = 'auc')
auc_all$al_type <- 'No random'
for (tcr in all_TCRs){
auc_files <- list.files(path = "../../figure_4/4a-b/BATMAN_AL_aucs/",
pattern = paste0("batman_AL_auc_",
tcr,"_.*.csv"),
full.names = TRUE)
auc_df <- data.frame()
for (file in auc_files){
# Read data
file_data <- read.csv(file)
auc_df <- rbind(auc_df, file_data)
}
}
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
View(auc_mean)
View(auc_mean)
View(auc_all)
View(auc_all)
View(auc_mean)
View(auc_all)
View(within_aucs)
View(within_aucs)
View(auc_all)
View(auc_all)
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
View(auc_all)
View(auc_all)
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
View(auc_all)
View(auc_all)
View(auc_all)
View(auc_all)
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
View(auc_all)
View(auc_all)
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
View(auc_all)
View(auc_all)
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
source("~/batman_resub/paper_figures/figure_S9/9a/plot_AL_aucs_for_figS9a.R")
