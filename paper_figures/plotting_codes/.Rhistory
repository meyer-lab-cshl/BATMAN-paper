"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1,1:3] <- rowMeans(AUROCs_logistic)
perf_all[method,tcr,2,1:3] <- rowMeans(AUROCs_Atchley)
perf_all[method,tcr,3,1:3] <- rowMeans(corrs_logistic)
perf_all[method,tcr,4,1:3] <- rowMeans(corrs_Atchley)
}
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
#For exporting cluster/local data to matlab
rm(list=ls())#Clear environment
library(pROC)
library(R.matlab)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1] <- mean(AUROCs_logistic)
perf_all[method,tcr,2] <- mean(AUROCs_Atchley)
perf_all[method,tcr,3] <- mean(corrs_logistic)
perf_all[method,tcr,4] <- mean(corrs_Atchley)
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
)
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1] <- mean(AUROCs_logistic)
perf_all[method,tcr,2] <- mean(AUROCs_Atchley)
perf_all[method,tcr,3] <- mean(corrs_logistic)
perf_all[method,tcr,4] <- mean(corrs_Atchley)
}
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
library(readxl)
AA_matrix_index <- 16
AA_matrix_name_list=c("hamming",paste(rep("blosum",13),seq(30,90,5),sep=""),"blosum62","blosum100",paste(rep("pam",50),seq(10,500,10),sep=""),"dayhoff","gonnet","atchley_l2","atchley_cos");
AA_matrix_name<-AA_matrix_name_list[AA_matrix_index] #name of the distance function
load(paste("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/distance_functions/",AA_matrix_name,".rda",sep=""))
AA_distance <- matrix(aa_mat,nrow=20,ncol=20,dimnames=list(AA_list,AA_list))
AA_list <- c('A','C','D','E','F','G','H','I','K','L','M','N','P','Q','R','S','T','V','W','Y')
AA_distance <- matrix(aa_mat,nrow=20,ncol=20,dimnames=list(AA_list,AA_list))
View(AA_distance)
View(AA_distance)
write.csv(AA_distance,'blosum100.csv')
file=paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/blosum100.csv")
write.csv(AA_distance,file)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
View(TCR_data)
View(TCR_data)
rm(list=ls())#Clear environment
library(xlsx)
rm(list=ls())#Clear environment
library(xlsx)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
tcr_name=TCR_data$tcr_name[TCR_data$tcr_name==TCR_names[TCR_index]]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
table(peptide_binding_category)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
library(xlsx)
set.seed(200+TCR_index)
nfold<-5#number of training folds
training_folds<-kfold_split_stratified(K = nfold, x = peptide_binding_category)#generate test indices for folds
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
TCR_data$tcr_name==TCR_names[TCR_index]
training_folds_all <- array(0,dim=5)
length(TCR_data)
size(TCR_data)
len(TCR_data)
length(TCR_data)[1]
length(TCR_data)[1][1]
length(TCR_data)[1][1][1]
length(TCR_data)[2]
nrow(TCR_data)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
TCR_names
TCR_names[tcr_list]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
R.matlab::readMat(aa_filename)
R.matlab::readMat(filename)
aa_mat <- array(unlist(R.matlab::readMat(aa_filename))$aa.mat,dim=c(20,20))
aa_mat <- array(unlist(R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
aa_mat <- array((R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
View(aa_mat)
View(aa_mat)
View(weights)
View(weights)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
aa_mat <- array((R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
weights <- array((R.matlab::readMat(filename))$weights,dim=c(9,11))
View(weights)
View(weights)
load('learned_1.rda')
rm(list=ls())#Clear environment
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//learned_5.rda"))
View(weights)
View(weights)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
length(tcr_list)
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//fit_symm_1.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//learned_5.rda"))
central_peptide <- unique(TCR_data$index_peptide[TCR_data$tcr_name==TCR_names[TCR_index]])
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
a<-pooled_symm_auc[,,1]
a
mean(a)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
mean(pooled_symm_auc)
mean(pooled_symm_auc[,1,])
mean(pooled_symm_auc[,2,])
mean(pooled_symm_auc[,3,])
a<-rowMeans(pooled_symm_auc)
mean(a)
median(a)
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//symm_auc.mat"),
pooled_symm_auc=pooled_symm_auc)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/full/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
<- unique(wt_peptides)
a <- unique(wt_peptides)
table(wt_peptides)
sort(table(wt_peptides))
sort(table(wt_peptides),decreasing=TRUE)
plot(roc)
plot(roc(peptide_immunogenicity,scores,direction="<"))
plot(roc(peptide_immunogenicity,PRIME_scores,direction="<"))
AUC_PRIME
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
plot(scores)
plot(scores-PRIME_scores)
plot(PRIME_scores)
plot(PRIME_scores,scores)
plot(scores,PRIME_scores)
auc(roc(peptide_immunogenicity,scores*PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/20+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/30+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/100+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/1000+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/1000*PRIME_scores,direction="<"))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
AUC <- auc(roc(peptide_immunogenicity,log(scores),direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction=">"))
AUC
auc(roc(peptide_immunogenicity,scores/1000*log(NetMHCpanBA_Kd),direction="<"))
auc(roc(peptide_immunogenicity,scores/1000*log(df$NetMHCpanBA_Kd),direction="<"))
auc(roc(peptide_immunogenicity,scores/(1000*log(df$NetMHCpanBA_Kd)),direction="<"))
auc(roc(peptide_immunogenicity,scores/(100*log(df$NetMHCpanBA_Kd)),direction="<"))
auc(roc(peptide_immunogenicity,scores/(log(df$NetMHCpanBA_Kd)),direction="<"))
df[1:10,3]
fit <- cv.glmnet(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli', type.measure = 'class', alpha = 1)
fit <- glm.fit(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli', type.measure = 'class', alpha = 1)
fit <- glm.fit(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli')
fit <- glm.fit(x = df[,c(3:21,24,25)], y = df[,22], family = 'bernoulli')
fit <- glm.fit(x = df[,c(3:21,24,25)], y = df[,22])
df[1,21]
fit <- glm.fit(x = df[,c(3:20,24,25)], y = df[,22])
fit <- glm.fit(x = df[,c(3:14,16:20,24,25)], y = df[,22])
df[1,c(3:14,16:20,24,25)]
fit <- glm.fit(x = df[,c(3:14,24,25)], y = df[,22])
fit <- glm.fit(x = df[,24:25], y = df[,22])
df[1:10,22]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
fit <- glm(x = df[,24:25], y = df[,22], family='binomial')
fit <- glm(x = df[,24:25], y = df[,22],formula = y~x, family='binomial')
fit <- glm(Data=df,formula = df[,22]~df[,24:25], family='binomial')
fit <- glm(Data=df,formula = Immunogenicity ~ scores + NetMHCpanBA_Kd + PRIME, family='bernoulli')
fit <- glm(Data=df,formula = Immunogenicity ~ scores + NetMHCpanBA_Kd + PRIME, family='binomial')
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
as.formula(paste("peptide_binding_category~1+",gsub(", ","+",toString(colnames(peptide_data)[1:peptide_length])),sep="")),
as.formula(paste("peptide_binding_category~1+",gsub(", ","+",toString(colnames(peptide_data)[1:peptide_length])),sep=""))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
data <- data.frame(df$Immunogenicity,df$scores,df$NetMHCpanBA_Kd,df$PRIME)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
AUC <- auc(roc(peptide_immunogenicity,18.44*PRIME_scores+0.06*scores,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,18.44*PRIME_scores,direction="<"))
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,0.4*df$NetMHCpanBA_Kd + 0.02*df$scores,direction="<"))
AUC
position_dependent_weights
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
TCR_names <- unique(TCR_data$tcr_name)
TCR_names
tcr_list <- 33:48
# Extract and align TCR CDR3a/b seqs for selected TCRs
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3a_list <- as.character(muscle(stringset = AAStringSet(x=cdr3a_list, start=NA, end=NA, width=NA, use.names=FALSE)))
library(muscle)
# Extract and align TCR CDR3a/b seqs for selected TCRs
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3a_list <- as.character(muscle(stringset = AAStringSet(x=cdr3a_list, start=NA, end=NA, width=NA, use.names=FALSE)))
cdr3b_list <- unique(TCR_data$cdr3b[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3b_list <- as.character(muscle(stringset = AAStringSet(x=cdr3b_list, start=NA, end=NA, width=NA, use.names=FALSE)))
cdr3a_list
cdr3a_list''
t(cdr3a_list)
t(cdr3b_list)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
TCR_index
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[1]]])
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[2]]])
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[3]]])
for (TCR_index in 1:length(tcr_list)) {
print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))
}
1:5
33:48
tcr_list <- 33:48
for (TCR_index in 1:length(tcr_list)) {
+ print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))
+ }
for (TCR_index in 1:length(tcr_list)) {print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))}
tcr_list <- setdiff(33:48,35)
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
length(unlist(strsplit(index_peptide,split="")))
loo_tcr
mean(loo_tcr)
colMeans(loo_tcr)
shiny::runApp('C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity')
sessionInfo()
library(brms)
sessionInfo()
library(pROC)
sessionInfo()
library(randomForest)
sessionInfo()
library(muscle)
sessionInfo()
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
tcr_names <- c(6,12,52,55,58,59,60,62,64,65,68)
TCR_names <- unique(TCR_data$tcr_name)
TCR_names[tcr_names]
source("C:/Users/amita/Downloads/paper_figures/plotting_codes/extended_data_fig_6a.R")
plot(peptide_activity,peptide_rank)
cor(peptide_activity,peptide_rank)
rm(list=ls())#Clear environment
# Load required libraries
library(readxl)
library(R.matlab)
library(pROC)
file <- paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods/nettepi//NetTepi_out_","HLA-A0201",".xls")
output_data <- read.table(file)
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
remove.packages('irlba')
install.packages('irlba')
install.packages('irlba')
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
a <- cor(counts[1,:],counts)
a <- cor(counts[1,],counts)
a <- cor(counts[1,],counts[2,])
dim(counts)
a <- cor(counts[1,],as.matrix(counts))
a <- cor(counts[,1],as.matrix(counts))
hist(a)
max(a)
which.max(a)
max(a[2:])
max(a[2:45877])
which.max(a[2:45877])
a[1:10]
dim(counts)
count[1:10,1]
counts[1:10,1]
c <- counts==0
c[1,1]
a <- colsum(c)
a <- sum(c,axis=1)
a <- rowsum(c)
a <- rowMeans(c)
sum(a!=0)
a
sum(a!=0)
counts['KLHL10',1]
dec <- modelGeneVar(sce)
hvg <- getTopHVGs(dec, prop=0.1)
dec <- modelGeneVar(sce)
hvg <- getTopHVGs(dec, prop=0.2)
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
counts <- counts[hvg[1:1024],]
dim(counts)
c<-cov(counts[1:5,1:10])
c<-cov(as.matrix(counts[1:5,1:10]))
c <- cov(t(as.matrix(counts)))
dim(c)
ev <- eigen(c)
ev <- eigen(c)$values
plot(ev)
plot(ev,log=c('x','y'))
plot(ev,log='xy')
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
ev[1]/sum(ev)
sum(ev[1:10])/sum(ev)
sum(ev[1:100])/sum(ev)
sum(ev[1:1000])/sum(ev)
sum(ev[1:100])/sum(ev)
sum(ev[1:1000])/sum(ev)
sum(ev[1:10])/sum(ev)
plot(ev)
object.size(counts)
hvg[1:10]
sum(ev)
max(counts)
min(counts)
sum([counts==0])
sum(counts==0)
sum(counts!=0)
mean(counts)
mean(counts[counts!=0])
counts_copy <- counts #make a copy
dim(counts)
counts_copy[counts==0] <- NA #change 0 to NA
normalization <- colMeans(counts_copy, na.rm = TRUE)
normalization <- rowMeans(counts_copy, na.rm = TRUE)
normalization <- matrix(rowMeans(counts_copy, na.rm = TRUE),ncol=ncol(counts))
normalization <- matrix(rowMeans(counts_copy, na.rm = TRUE),nrow=nrow(counts),ncol=ncol(counts))
normalization[1,10]
normalization[1,11]
normalization[1:10,103]
normalization[1:10,1034]
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
ev <- eigen(gene_cov)$values
sum(ev[1:10])/sum(ev)
sum(ev[1:2])/sum(ev)
plot(ev,log='xy')
a=rowMeans(counts_copy, na.rm = TRUE)
a[1:10]
normalization[1,1:10]
normalization[1:10,1]
normalization[1:10,1034]
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
plot(ev,log='xy')
ev <- eigen(gene_cov)$values
plot(ev,log='xy')
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
ev <- eigen(gene_cov)$values
plot(ev,log='xy')
gene_cov[1:2,1:2]
c <- counts[10,]
mean(c[c!=0])
mean(c)
1:3
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
cell_cov <- WGCNA::cor(counts)
BiocManager::install("Biobase")
BiocManager::install("GO.db")
BiocManager::valid()
cell_cov <- WGCNA::cor(counts)
BiocManager::install("impute")
cell_cov <- WGCNA::cor(counts)
BiocManager::install("preprocessCore")
cell_cov <- WGCNA::cor(counts)
dim(cell_cov)
object.size(cell_cov)
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
library(BiocManager)
install("BiocFileCache")
source("C:/Users/amita/Downloads/exploratory_scrnaseq/basic_pipeline.R")
source("~/GitHub/BATMAN-paper/paper_figures/plotting_codes/extended_data_fig_8a.R")
View(plot_data)
View(plot_data)
p <- plot_data[plot_data$type=="No AL",]
p1 <- plot_data[plot_data$type=="No AL",]
p2 <- plot_data[plot_data$type=="Even steps random",]
p2 <- p2[p2$method==9,]
p <- rbind(p1,p2)
View(p)
View(p)
p <- p[,1:3]
p_wide <- spread(p)
library(reshape2)
p_wide <- melt(p)
View(p_wide)
View(p_wide)
View(p_wide,id.vars="tcr")
p_wide <- melt(p,id.vars="tcr")
View(p_wide)
View(p_wide)
p_wide <- melt(p,id.vars="method")
View(p_wide)
View(p_wide)
p_wide <- melt(p,id.vars="score")
View(p_wide)
View(p_wide)
p_wide <- reshape(p,idvar="tcr")
p_wide <- reshape(p,idvar="tcr",direction="wide")
p_wide <- reshape(p,idvar="tcr",timevar="method",direction="wide")
View(p_wide)
View(p_wide)
colnames(p) <- c("tcr","within","loo","al")
colnames(p_wide) <- c("tcr","within","loo","al")
write.csv(p_wide,"auc_improvement_by_al.csv")
