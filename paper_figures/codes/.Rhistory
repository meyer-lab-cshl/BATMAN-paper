peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
TCR_index <- 62#select tcr
# Extract peptides and their activities for a particular TCR
peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
TCR_index <- 63#select tcr
# Extract peptides and their activities for a particular TCR
peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
TCR_index <- 64#select tcr
# Extract peptides and their activities for a particular TCR
peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
TCR_index <- 65#select tcr
# Extract peptides and their activities for a particular TCR
peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
TCR_index <- 66#select tcr
# Extract peptides and their activities for a particular TCR
peptide_list <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]]
peptide_activity <- TCR_data$peptide_activity[TCR_data$tcr_name==TCR_names[TCR_index]]
index_peptide <- TCR_data$peptide[TCR_data$tcr_name==TCR_names[TCR_index]][which.max(peptide_activity)]
peptide_activity<-peptide_activity/(peptide_activity[which.max(peptide_activity)])
peptide_binding_category <- matrix(2,nrow=length(peptide_list),ncol=1)#Initialize with all weak binders
peptide_binding_category[peptide_activity<0.1]=1 #Non-binder
peptide_binding_category[peptide_activity>=0.5]=3 #strong-binder
peptide_binding_category<- as.integer(peptide_binding_category)
table(peptide_binding_category)
AA_matrix_name_list=c("hamming",paste(rep("blosum",13),seq(30,90,5),sep=""),"blosum62","blosum100",paste(rep("pam",50),seq(10,500,10),sep=""),"dayhoff","gonnet","atchley_l2","atchley_cos","fit_symm","fit_full");
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/inferred_matrices/symm_aa_matrix/blosum_filling/blosum_prior/AA_matrix_generator.R")
View(aa_mat)
View(aa_mat)
AA_matrix_name_list=c("hamming",paste(rep("blosum",13),seq(30,90,5),sep=""),"blosum62","blosum100",paste(rep("pam",50),seq(10,500,10),sep=""),"dayhoff","gonnet","atchley_l2","atchley_cos","learned");
AA_matrix_name<-AA_matrix_name_list[1] #name of the distance function
load(paste("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/distance_functions/",AA_matrix_name,".rda",sep=""))
View(aa_mat)
View(aa_mat)
AA_matrix_name_list=c("hamming",paste(rep("blosum",13),seq(30,90,5),sep=""),"blosum62","blosum100",paste(rep("pam",50),seq(10,500,10),sep=""),"dayhoff","gonnet","atchley_l2","atchley_cos","fit_symm","fit_full");
AA_matrix_name_list[67:72]
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
TCR_names <- unique(TCR_data$tcr_name)
TCR_names
TCR_names[c(1 6 12 48 52 55 58 59 60 62 63 64 65)]
TCR_names[c(1,6,12,48,52,55,58,59,60,62,63,64,65)]
method_list <- c(1,16,17,67,68,69,71,72)
length(method_list)
#For exporting cluster/local data to matlab
rm(list=ls())#Clear environment
library(pROC)
library(R.matlab)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1] <- mean(AUROCs_logistic)
perf_all[method,tcr,2] <- mean(AUROCs_Atchley)
perf_all[method,tcr,3] <- mean(corrs_logistic)
perf_all[method,tcr,4] <- mean(corrs_Atchley)
}
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
AUROCs_logistic
mean(AUROCs_logistic)
rowMeans(AUROCs_logistic)
#For exporting cluster/local data to matlab
rm(list=ls())#Clear environment
library(pROC)
library(R.matlab)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4,3))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1,1:3] <- rowMeans(AUROCs_logistic)
perf_all[method,tcr,2,1:3] <- rowMeans(AUROCs_Atchley)
perf_all[method,tcr,3,1:3] <- rowMeans(corrs_logistic)
perf_all[method,tcr,4,1:3] <- rowMeans(corrs_Atchley)
}
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
#For exporting cluster/local data to matlab
rm(list=ls())#Clear environment
library(pROC)
library(R.matlab)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1] <- mean(AUROCs_logistic)
perf_all[method,tcr,2] <- mean(AUROCs_Atchley)
perf_all[method,tcr,3] <- mean(corrs_logistic)
perf_all[method,tcr,4] <- mean(corrs_Atchley)
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
)
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
method_list <- c(1,16,17,67,68,69,71,72)
tcr_list <- c(1,6,12,48,52,55,58,59,60,62,63,64,65)
perf_all <- array(0,dim=c(length(method_list),length(tcr_list),4))
for (method in 1:length(method_list)) {
for (tcr in 1:length(tcr_list)){
load(paste("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/elzar_outputs/",
"outputs_3class_bayes_atchley//output_",method_list[method],
"_",tcr_list[tcr],".rda",sep=""))
perf_all[method,tcr,1] <- mean(AUROCs_logistic)
perf_all[method,tcr,2] <- mean(AUROCs_Atchley)
perf_all[method,tcr,3] <- mean(corrs_logistic)
perf_all[method,tcr,4] <- mean(corrs_Atchley)
}
}
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//all_outputs.mat"),
perf_all=perf_all)
library(readxl)
AA_matrix_index <- 16
AA_matrix_name_list=c("hamming",paste(rep("blosum",13),seq(30,90,5),sep=""),"blosum62","blosum100",paste(rep("pam",50),seq(10,500,10),sep=""),"dayhoff","gonnet","atchley_l2","atchley_cos");
AA_matrix_name<-AA_matrix_name_list[AA_matrix_index] #name of the distance function
load(paste("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/distance_functions/",AA_matrix_name,".rda",sep=""))
AA_distance <- matrix(aa_mat,nrow=20,ncol=20,dimnames=list(AA_list,AA_list))
AA_list <- c('A','C','D','E','F','G','H','I','K','L','M','N','P','Q','R','S','T','V','W','Y')
AA_distance <- matrix(aa_mat,nrow=20,ncol=20,dimnames=list(AA_list,AA_list))
View(AA_distance)
View(AA_distance)
write.csv(AA_distance,'blosum100.csv')
file=paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/blosum100.csv")
write.csv(AA_distance,file)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
View(TCR_data)
View(TCR_data)
rm(list=ls())#Clear environment
library(xlsx)
rm(list=ls())#Clear environment
library(xlsx)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
tcr_name=TCR_data$tcr_name[TCR_data$tcr_name==TCR_names[TCR_index]]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
table(peptide_binding_category)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
library(xlsx)
set.seed(200+TCR_index)
nfold<-5#number of training folds
training_folds<-kfold_split_stratified(K = nfold, x = peptide_binding_category)#generate test indices for folds
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
TCR_data$tcr_name==TCR_names[TCR_index]
training_folds_all <- array(0,dim=5)
length(TCR_data)
size(TCR_data)
len(TCR_data)
length(TCR_data)[1]
length(TCR_data)[1][1]
length(TCR_data)[1][1][1]
length(TCR_data)[2]
nrow(TCR_data)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
TCR_names
TCR_names[tcr_list]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
R.matlab::readMat(aa_filename)
R.matlab::readMat(filename)
aa_mat <- array(unlist(R.matlab::readMat(aa_filename))$aa.mat,dim=c(20,20))
aa_mat <- array(unlist(R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
aa_mat <- array((R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
View(aa_mat)
View(aa_mat)
View(weights)
View(weights)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/read_AA_matrix_weights.R")
aa_mat <- array((R.matlab::readMat(filename))$aa.mat,dim=c(20,20))
weights <- array((R.matlab::readMat(filename))$weights,dim=c(9,11))
View(weights)
View(weights)
load('learned_1.rda')
rm(list=ls())#Clear environment
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//learned_5.rda"))
View(weights)
View(weights)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
length(tcr_list)
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//fit_symm_1.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//learned_5.rda"))
central_peptide <- unique(TCR_data$index_peptide[TCR_data$tcr_name==TCR_names[TCR_index]])
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
a<-pooled_symm_auc[,,1]
a
mean(a)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/calculate_auc.R")
mean(pooled_symm_auc)
mean(pooled_symm_auc[,1,])
mean(pooled_symm_auc[,2,])
mean(pooled_symm_auc[,3,])
a<-rowMeans(pooled_symm_auc)
mean(a)
median(a)
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"distance_function_learning/tcrs_pooled_5_fold_cv//symm_auc.mat"),
pooled_symm_auc=pooled_symm_auc)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/tcrs_pooled_5_fold_cv/full/make_5_folds.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
<- unique(wt_peptides)
a <- unique(wt_peptides)
table(wt_peptides)
sort(table(wt_peptides))
sort(table(wt_peptides),decreasing=TRUE)
plot(roc)
plot(roc(peptide_immunogenicity,scores,direction="<"))
plot(roc(peptide_immunogenicity,PRIME_scores,direction="<"))
AUC_PRIME
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
plot(scores)
plot(scores-PRIME_scores)
plot(PRIME_scores)
plot(PRIME_scores,scores)
plot(scores,PRIME_scores)
auc(roc(peptide_immunogenicity,scores*PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/20+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/30+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/100+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/1000+PRIME_scores,direction="<"))
auc(roc(peptide_immunogenicity,scores/1000*PRIME_scores,direction="<"))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
AUC <- auc(roc(peptide_immunogenicity,log(scores),direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction=">"))
AUC
auc(roc(peptide_immunogenicity,scores/1000*log(NetMHCpanBA_Kd),direction="<"))
auc(roc(peptide_immunogenicity,scores/1000*log(df$NetMHCpanBA_Kd),direction="<"))
auc(roc(peptide_immunogenicity,scores/(1000*log(df$NetMHCpanBA_Kd)),direction="<"))
auc(roc(peptide_immunogenicity,scores/(100*log(df$NetMHCpanBA_Kd)),direction="<"))
auc(roc(peptide_immunogenicity,scores/(log(df$NetMHCpanBA_Kd)),direction="<"))
df[1:10,3]
fit <- cv.glmnet(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli', type.measure = 'class', alpha = 1)
fit <- glm.fit(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli', type.measure = 'class', alpha = 1)
fit <- glm.fit(x = df[,3:25], y = df$Immunogenicity, family = 'bernoulli')
fit <- glm.fit(x = df[,c(3:21,24,25)], y = df[,22], family = 'bernoulli')
fit <- glm.fit(x = df[,c(3:21,24,25)], y = df[,22])
df[1,21]
fit <- glm.fit(x = df[,c(3:20,24,25)], y = df[,22])
fit <- glm.fit(x = df[,c(3:14,16:20,24,25)], y = df[,22])
df[1,c(3:14,16:20,24,25)]
fit <- glm.fit(x = df[,c(3:14,24,25)], y = df[,22])
fit <- glm.fit(x = df[,24:25], y = df[,22])
df[1:10,22]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
fit <- glm(x = df[,24:25], y = df[,22], family='binomial')
fit <- glm(x = df[,24:25], y = df[,22],formula = y~x, family='binomial')
fit <- glm(Data=df,formula = df[,22]~df[,24:25], family='binomial')
fit <- glm(Data=df,formula = Immunogenicity ~ scores + NetMHCpanBA_Kd + PRIME, family='bernoulli')
fit <- glm(Data=df,formula = Immunogenicity ~ scores + NetMHCpanBA_Kd + PRIME, family='binomial')
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
as.formula(paste("peptide_binding_category~1+",gsub(", ","+",toString(colnames(peptide_data)[1:peptide_length])),sep="")),
as.formula(paste("peptide_binding_category~1+",gsub(", ","+",toString(colnames(peptide_data)[1:peptide_length])),sep=""))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
data <- data.frame(df$Immunogenicity,df$scores,df$NetMHCpanBA_Kd,df$PRIME)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
AUC <- auc(roc(peptide_immunogenicity,18.44*PRIME_scores+0.06*scores,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,18.44*PRIME_scores,direction="<"))
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
peptide_classifier$fit
AUC <- auc(roc(peptide_immunogenicity,df$NetMHCpanBA_Kd,direction="<"))
AUC
AUC <- auc(roc(peptide_immunogenicity,0.4*df$NetMHCpanBA_Kd + 0.02*df$scores,direction="<"))
AUC
position_dependent_weights
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/distance_function_learning/immunogenicity_prediction/predict_immunogenicity.R")
AUC
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
TCR_names <- unique(TCR_data$tcr_name)
TCR_names
tcr_list <- 33:48
# Extract and align TCR CDR3a/b seqs for selected TCRs
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3a_list <- as.character(muscle(stringset = AAStringSet(x=cdr3a_list, start=NA, end=NA, width=NA, use.names=FALSE)))
library(muscle)
# Extract and align TCR CDR3a/b seqs for selected TCRs
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3a_list <- as.character(muscle(stringset = AAStringSet(x=cdr3a_list, start=NA, end=NA, width=NA, use.names=FALSE)))
cdr3b_list <- unique(TCR_data$cdr3b[TCR_data$tcr_name %in% TCR_names[tcr_list]])
cdr3b_list <- as.character(muscle(stringset = AAStringSet(x=cdr3b_list, start=NA, end=NA, width=NA, use.names=FALSE)))
cdr3a_list
cdr3a_list''
t(cdr3a_list)
t(cdr3b_list)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
TCR_index
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[1]]])
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[2]]])
unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[3]]])
for (TCR_index in 1:length(tcr_list)) {
print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))
}
1:5
33:48
tcr_list <- 33:48
for (TCR_index in 1:length(tcr_list)) {
+ print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))
+ }
for (TCR_index in 1:length(tcr_list)) {print(c(TCR_index,unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list[TCR_index]]])))}
tcr_list <- setdiff(33:48,35)
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/atchley/TCR_LOO_Atchley.R")
length(unlist(strsplit(index_peptide,split="")))
loo_tcr
mean(loo_tcr)
colMeans(loo_tcr)
shiny::runApp('C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity')
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
tcr <- unique(TCR_data$cdr3a)
tcr
tcr <- unique(TCR_data$cdr3b)
tcr
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
tcr <- unique(TCR_data$cdr3b)
tcr
source("C:/Users/amita/Downloads/paper_figures/plotting_codes/extended_data_fig_3.R")
source("C:/Users/amita/Downloads/paper_figures/plotting_codes/extended_data_fig_3.R")
source("C:/Users/amita/Downloads/paper_figures/codes/loo_tcr_atchley.R")
weights_all <- read.csv(paste0('../data/within_tcr_pooled/weights_only/',
'weights_all_',9,
'_mer_fold_',0,'.csv'))
tcr <- unique(TCR_data$cdr3b)
tcr
TCR_data <- TCR_data[TCR_data$cdr3a!="NA" & TCR_data$cdr3b!="NA"]
TCR_data <- TCR_data[TCR_data$cdr3a!="NA" & TCR_data$cdr3b!="NA",]
index <- TCR_data$index_peptide
i <- nchar(index)
i
cdr3a_list <- unique(TCR_data$cdr3a[TCR_data$tcr_name %in% TCR_names[tcr_list]])
rep('X',15)
r<-rep('X',15)
TCR_names <- unique(TCR_data$tcr_name)
length(TCR_names)
# Load TCR and peptide information from the main TCR datafile
suppressWarnings(
TCR_data <- read_excel("../data/TCR_epitope_database.xlsx")
)
# Discard TCRs without CDR3a/b seqs
TCR_data <- TCR_data[TCR_data$cdr3a!="NA" & TCR_data$cdr3b!="NA",]
# Use all 9-mer-binding TCRs
TCR_data <- TCR_data[nchar(TCR_data$index_peptide)==9,]
# Extract TCR names present in the data
TCR_names <- unique(TCR_data$tcr_name)
# Extract and align TCR CDR3a/b seqs for selected TCRs
cdr3a_list <- rep('X',length(TCR_names))
cdr3b_list <- rep('X',length(TCR_names))
for (tcr in 1:length(TCR_names)){
cdr3a_list[tcr] <- unique(TCR_data$cdr3a[TCR_data$tcr_name==TCR_names[tcr],])
cdr3b_list[tcr] <- unique(TCR_data$cdr3b[TCR_data$tcr_name==TCR_names[tcr],])
}
for (tcr in 1:length(TCR_names)){
cdr3a_list[tcr] <- unique(TCR_data$cdr3a[TCR_data$tcr_name==TCR_names[tcr]])
cdr3b_list[tcr] <- unique(TCR_data$cdr3b[TCR_data$tcr_name==TCR_names[tcr]])
}
cdr3a_list <- as.character(muscle(stringset = AAStringSet(x=cdr3a_list,
start=NA,
end=NA,
width=NA,
use.names=FALSE)))
cdr3b_list <- as.character(muscle(stringset = AAStringSet(x=cdr3b_list,
start=NA,
end=NA,
width=NA,
use.names=FALSE)))
length(TCR_data)
len(TCR_data)
size(TCR_data)
dim(TCR_data)
dim(TCR_data)[1]
