library(readxl)
TCR_data <- read_excel("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/TCR_epitope_database.xlsx")
TCR_names <- unique(TCR_data$tcr_name)
TCR_names[c(6,12,52,55,58,59,60,62,64,65,68)]
tcr_list <- c(6,12,52,55,58,59,60,62,64,65,68)
mhc_list <- array("HLA-A0201",dim=c(1,length(tcr_list)))
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
data <- read.table(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods/prime//result_",mhc_list[TCR],".txt"))
m<-match(peptide_list,data$V1)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
peptide_rank
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
peptide_binding_category[training_folds==fold]
peptide_rank[training_folds==fold]
ROC<-multiclass.roc(peptide_binding_category[training_folds==fold],peptide_rank[training_folds==fold],direction="<")
auc(ROC$rocs[[1]])
auc(ROC$rocs[[2]])
auc(ROC$rocs[[3]])
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
aucs_prime
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
aucs_prime
mean(aucs_prime)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/prime/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/iedb/calculate_auc.R")
output_data <- read.table(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods/iedb//result_",mhc_list[2],".csv"))
View(output_data)
View(output_data)
d<-split.data.frame(output_data,",")
d<-split.data.frame(output_data$V1,",")
d<-split(output_data$V1,",")
d<-unlist(stringsplit(output_data$V1,","))
d<-unlist(strsplit(output_data$V1,","))
d<-unlist(strsplit(output_data$V1,","),dim=c(3,length(output_data$V1)))
d
output_data<-unlist(strsplit(output_data$V1,","))
output_seqs <- output_data[4:3:]
output_seqs <- output_data[4:3:end]
output_seqs <- output_data[4:end:3]
output_seqs <- output_data[seq(4,end,3)]
output_seqs <- output_data[seq(4,10,3)]
length(output_data)/3
output_seqs <- output_data[seq(4,length(output_data)/3-1,3)]
output_seqs
d[end]
d[5325]
d[5324]
d[5322]
d[5323]
output_seqs <- output_data[seq(4,length(output_data)-2,3)]
output_seqs[1774]
output_score <- output_data[seq(6,length(output_data),3)]
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/iedb/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/iedb/calculate_auc.R")
aucs_iedb
peptide_score
peptide_list
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/iedb/calculate_auc.R")
aucs_iedb
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/iedb/calculate_auc.R")
aucs_iedb
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
output_data <- read_excel(file)
output_data <- read.table(file)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
aucs_nettepi
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
source("C:/Users/amita/Downloads/epitope_analysis/antigen-availability-master/antigen-availability-master/TCR-crossreactivity/final_codes/local_outputs/misc_methods/nettepi/calculate_auc.R")
mean(aucs_nettepi)
aucs_nettepi
ROC<-multiclass.roc(peptide_binding_category,peptide_score,direction="<")
c(auc(ROC$rocs[[1]]),auc(ROC$rocs[[2]]),auc(ROC$rocs[[3]]))
mean(c(auc(ROC$rocs[[1]]),auc(ROC$rocs[[2]]),auc(ROC$rocs[[3]])))
peptide_score
rm(list=ls())#Clear environment
library(pROC)
library(R.matlab)
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods//msk_output.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods//msk_outputs.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods//iedb_outputs.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods//prime_outputs.rda"))
load(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/local_outputs/",
"misc_methods//nettepi_outputs.rda"))
writeMat(paste0("C:/Users/amita/Downloads/epitope_analysis/",
"antigen-availability-master/antigen-availability-master/",
"TCR-crossreactivity/final_codes/matlab_inputs//misc_methods_outputs.mat"),
aucs_iedb=aucs_iedb,aucs_msk=aucs_msk,aucs_nettepi=aucs_nettepi,aucs_prime=aucs_prime)
